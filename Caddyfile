vsbuilder.techifyboost.com {
    # Reverse proxy to the app container
    reverse_proxy app:3000 {
        # Disable passive health checks (we trust Docker's health check)
        lb_try_duration 0
    }

    # Security headers for Shopify iframe compatibility
    header {
        Content-Security-Policy "frame-ancestors https://*.myshopify.com https://admin.shopify.com;"
        X-Content-Type-Options "nosniff"
        Referrer-Policy "strict-origin-when-cross-origin"
        -X-Frame-Options
    }
}

# HTTP to HTTPS redirect
:80 {
    redir https://{host}{uri} permanent
}
